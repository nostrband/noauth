import{CBORcontainer as o}from"./container.js";import{DecodeStream as d}from"./decodeStream.js";import{SYMS as f}from"./constants.js";function O(a,i={}){const n={...o.defaultDecodeOptions};if(i.dcbor?Object.assign(n,o.dcborDecodeOptions):i.cde&&Object.assign(n,o.cdeDecodeOptions),Object.assign(n,i),Object.hasOwn(n,"rejectLongNumbers"))throw new TypeError("rejectLongNumbers has changed to requirePreferred");n.boxed&&(n.saveOriginal=!0);const t=new d(a,n);let e,r;for(const s of t){if(r=o.create(s,e,n,t),s[2]===f.BREAK)if(e?.isStreaming)e.left=0;else throw new Error("Unexpected BREAK");else e&&e.push(r,t,s[3]);for(r instanceof o&&(e=r);e?.done;){r=e.convert(t);const c=e.parent;c?.replaceLast(r,e,t),e=c}}return r}export{O as decode};
